(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionSpans_index_tsx"],{"./app/components/events/searchBar.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>I}),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/core-js/modules/es.array.includes.js");var n=s("../node_modules/react/index.js"),r=s("../node_modules/lodash/assign.js"),a=s.n(r),i=s("../node_modules/lodash/flatten.js"),o=s.n(i),c=s("../node_modules/lodash/memoize.js"),p=s.n(c),l=s("../node_modules/lodash/omit.js"),u=s.n(l),d=s("./app/actionCreators/tags.tsx"),m=s("./app/components/smartSearchBar/index.tsx"),g=s("./app/constants/index.tsx"),x=s("./app/types/index.tsx"),h=s("./app/utils.tsx"),v=s("./app/utils/discover/fields.tsx"),y=s("./app/utils/fields/index.ts"),f=s("./app/utils/measurements/measurements.tsx"),S=s("./app/utils/useApi.tsx"),T=s("./app/utils/withTags.tsx"),E=s("./app/views/dashboards/utils.tsx"),j=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const b=new RegExp(`^${g.c$}|\\${g.ir}`,"g"),w=new Set(Object.keys(v.wZ)),Z=Object.keys(v.wZ).reduce(((e,t)=>(e[t]={...v.wZ[t],kind:y.IV.FIELD},e)),{}),k=u()(Z,v.J8),_=v.$4.reduce(((e,t)=>(e[t]={name:t,kind:y.IV.METRICS},e)),{}),O=Object.keys(v.jg).reduce(((e,t)=>(e[t]={...v.jg[t],kind:y.IV.FIELD},e)),{});function C(e){const{maxSearchItems:t,organization:s,tags:r,omitTags:i,fields:c,projectIds:l,includeSessionTagsValues:g,maxMenuHeight:T,customMeasurements:C}=e,I=(0,S.Z)(),P=(0,n.useMemo)((()=>(e=>e?.length?e.reduce(((e,t)=>(w.has(t.field)||(0,v.GO)(t.field)||(0,E.nk)(t.field)||(e[t.field]={key:t.field,name:t.field,kind:y.IV.FUNCTION}),e)),{}):[])(c)),[c]),q=(0,n.useMemo)((()=>Object.keys(r).reduce(((e,t)=>(e[t]={...r[t],kind:y.IV.TAG},e)),{})),[r]);(0,n.useEffect)((()=>{N.cache.clear?.()}),[l]);const N=p()(((e,t,n)=>{const r=l?.map(String);return(0,v.h1)(e.key)||(0,v.Xr)(e.key)?Promise.resolve([]):(0,d.Fo)({api:I,orgSlug:s.slug,tagKey:e.key,search:t,projectIds:r,endpointParams:n,includeTransactions:!0,includeSessions:g}).then((e=>o()(e.filter((e=>{let{name:t}=e;return(0,h.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:s}=e;return`${s}-${t}`})),L=e=>{const t=((e,t)=>{const s=Object.keys(e).reduce(((t,s)=>(t[s]={...e[s],kind:y.IV.MEASUREMENT},t)),{});return t?Object.keys(t).reduce(((e,s)=>(e[s]={...t[s],kind:y.IV.MEASUREMENT},e)),s):s})(e,C),n=s.features.includes("performance-view")?Object.assign({},t,P,_,Z):Object.assign({},k);return a()(n,q,Z,O),n.has={key:y.Sh.HAS,name:"Has property",values:Object.keys(n).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),predefined:!0,kind:y.IV.FIELD},i&&i.length>0?u()(n,i):n};return(0,j.tZ)(f.Z,{children:s=>{let{measurements:n}=s;return(0,j.tZ)(m.Z,{hasRecentSearches:!0,savedSearchType:x.L4.EVENT,onGetTagValues:N,supportedTags:L(n),prepareQuery:e=>e.replace(b,""),maxSearchItems:t,excludedTags:[y.Sh.ENVIRONMENT,y.Sh.TOTAL_COUNT],maxMenuHeight:T??300,customPerformanceMetrics:C,...e})}})}C.displayName="SearchBar";const I=(0,T.Z)(C)},"./app/components/gridEditable/sortLink.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>g});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/react-router/es/index.js"),a=s("../node_modules/lodash/omit.js"),i=s.n(a),o=s("./app/components/links/link.tsx"),c=s("./app/icons/index.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){let{align:t,title:s,canSort:n,generateSortLink:a,onClick:i,direction:o,replace:c}=e;const l=a();if(!l||!n)return(0,p.tZ)(d,{align:t,children:s});const g=o?(0,p.tZ)(m,{size:"xs",direction:"desc"===o?"down":"up"}):null;return(0,p.BX)(u,{align:t,to:l,onClick:e=>{c&&(e.preventDefault(),r.browserHistory.replace(l)),i?.(e)},children:[s," ",g]})}l.displayName="SortLink";const u=(0,n.Z)((e=>{const t=i()(e,["align","css"]);return(0,p.tZ)(o.Z,{...t})}),{target:"esdhr0u2"})("display:block;width:100%;white-space:nowrap;color:inherit;&:hover,&:active,&:focus,&:visited{color:inherit;}",(e=>e.align?`text-align: ${e.align};`:""),";"),d=(0,n.Z)("div",{target:"esdhr0u1"})("display:block;width:100%;white-space:nowrap;",(e=>e.align?`text-align: ${e.align};`:""),";"),m=(0,n.Z)(c.CC,{target:"esdhr0u0"})({name:"40f4ru",styles:"vertical-align:top"}),g=l},"./app/utils/discover/discoverQuery.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>c,_:()=>o});var n=s("./app/utils/discover/genericDiscoverQuery.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function i(e){return(0,r.tZ)(n.ZP,{route:"events",shouldRefetchData:a,afterFetch:(e,t)=>{const{fields:s,...n}=e.meta??{};return{...e,meta:{...s,...n}}},...e})}function o(e){return(0,n.JC)({route:"events",shouldRefetchData:a,afterFetch:(e,t)=>{const{fields:s,...n}=e.meta??{};return{...e,meta:{...s,...n}}},...e})}i.displayName="DiscoverQuery";const c=i},"./app/utils/performance/suspectSpans/suspectSpansQuery.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s("../node_modules/lodash/omit.js"),r=s.n(n),a=s("./app/utils.tsx"),i=s("./app/utils/discover/genericDiscoverQuery.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){const{perSuspect:t,spanOps:s,spanGroups:n,minExclusiveTime:r,maxExclusiveTime:i}=e,o={perSuspect:t,spanOp:s,spanGroup:n,min_exclusive_time:r,max_exclusive_time:i};(0,a.ri)(o.perSuspect)||delete o.perSuspect,(0,a.ri)(o.spanOp)||delete o.spanOp,(0,a.ri)(o.spanGroup)||delete o.spanGroup;const c=e.eventView.getEventsAPIPayload(e.location);return{...o,...c}}function p(e){return(0,o.tZ)(i.ZP,{route:"events-spans-performance",getRequestPayload:c,...r()(e,"children"),children:t=>{let{tableData:s,...n}=t;return e.children({suspectSpans:s,...n})}})}p.displayName="SuspectSpansQuery";const l=p},"./app/utils/withTags.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/react/index.js"),a=s("./app/stores/tagStore.tsx"),i=s("./app/utils/getDisplayName.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c=function(e){class t extends r.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{tags:a.Z.getState()}),(0,n.Z)(this,"unsubscribe",a.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...s}=this.props;return(0,o.tZ)(e,{tags:t??this.state.tags,...s})}}return t.displayName="WithTags",(0,n.Z)(t,"displayName",`withTags(${(0,i.Z)(e)})`),t}},"./app/views/performance/transactionSummary/transactionSpans/index.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>$});var n=s("./app/locale.tsx"),r=s("./app/utils/withOrganization.tsx"),a=s("./app/utils/withProjects.tsx"),i=s("./app/views/performance/transactionSummary/pageLayout.tsx"),o=s("./app/views/performance/transactionSummary/tabs.tsx"),c=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),p=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),l=s("../node_modules/react-router/es/index.js"),u=s("../node_modules/lodash/omit.js"),d=s.n(u),m=s("./app/components/compactSelect/index.tsx"),g=s("./app/components/datePageFilter.tsx"),x=s("./app/components/environmentPageFilter.tsx"),h=s("./app/components/events/searchBar.tsx"),v=s("./app/components/layouts/thirds.tsx"),y=s("./app/components/organizations/pageFilterBar.tsx"),f=s("./app/components/organizations/pageFilters/parse.tsx"),S=s("./app/components/pagination.tsx"),T=s("./app/styles/space.tsx"),E=s("./app/utils.tsx"),j=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),b=s("./app/utils/discover/discoverQuery.tsx"),w=s("./app/utils/performance/suspectSpans/suspectSpansQuery.tsx"),Z=s("./app/utils/queryString.tsx"),k=s("./app/utils/useProjects.tsx"),_=s("./app/components/performance/waterfall/utils.tsx"),O=s("./app/icons/index.tsx"),C=s("./app/utils/discover/genericDiscoverQuery.tsx"),I=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function P(e){return(0,I.tZ)(C.ZP,{route:"events-span-ops",limit:20,...d()(e,"children"),children:t=>{let{tableData:s,...n}=t;return e.children({spanOps:s,...n})}})}P.displayName="SpanOpsQuery";const q=P;var N=s("./app/utils/tokenizeSearch.tsx");function L(e){let{spanOps:t,isLoading:s,error:r}=e;return s?[{value:"isLoading",disabled:!0,label:(0,n.t)("Loadingâ€¦")}]:r?[{value:"error",disabled:!0,label:(0,n.t)("Error loading operations"),leadingItems:(0,I.tZ)(O.FC,{color:"subText"})}]:t.map((e=>({value:e.op,label:e.op,leadingItems:(0,I.tZ)(V,{backgroundColor:(0,_.hd)(e.op)})})))}function z(e){const{location:t,eventView:s,organization:r,handleOpChange:a,transactionName:i}=e,o=new N.MY("");o.setFilterValues("event.type",["transaction"]).setFilterValues("transaction",[i]);const c=s.clone();c.query=o.formatString();const p=(0,Z.ro)(t.query.spanOp);return(0,I.tZ)(q,{location:t,orgSlug:r.slug,eventView:c,cursor:"0:0:1",noPagination:!0,children:e=>(0,I.tZ)(m.Z,{clearable:!0,maxMenuWidth:"24rem",disallowEmptySelection:!1,menuTitle:(0,n.t)("Filter by operation"),options:L(e),onChange:e=>a(e?.value),value:p,triggerLabel:p??(0,n.t)("Filter"),triggerProps:{icon:(0,I.tZ)(O.wH,{})}})})}z.displayName="OpsFilter";const V=(0,c.Z)("div",{target:"e8oacth0"})("display:block;width:",(0,T.D)(1),";height:",(0,T.D)(1),";border-radius:100%;background-color:",(e=>e.backgroundColor),";");var D=s("./app/views/performance/transactionSummary/transactionSpans/suspectSpansTable.tsx"),M=s("./app/views/performance/transactionSummary/transactionSpans/utils.tsx");const F={spanOp:(e,t)=>(0,j.Z)("performance_views.spans.change_op",{organization:e,operation_name:t}),sort:(e,t)=>(0,j.Z)("performance_views.spans.change_sort",{organization:e,sort_column:t})};function A(e){const{location:t,organization:s,eventView:n,projectId:r,transactionName:a}=e,i=(0,Z.ro)(t.query.query,"");function o(e){return function(n){F[e]?.(s,n);const r=(0,f.fK)({...t.query||{},[e]:n}),a=["cursor"];(0,E.ri)(n)||a.push(e);const i=d()(r,a);l.browserHistory.push({...t,query:i})}}const c=(0,Z.ro)(t.query.spanOp),u=(0,Z.ro)(t.query.spanGroup),h=(0,M.KK)(n),T=function(e,t){e=e.clone();const s=M.uQ[t];return e.fields=s?s.map((e=>({field:e}))):[],e}(n,h.field),j=(0,M.zW)(n),{projects:_}=(0,k.Z)();return(0,I.BX)(v.or,{fullWidth:!0,children:[(0,I.BX)(B,{children:[(0,I.tZ)(z,{location:t,eventView:n,organization:s,handleOpChange:o("spanOp"),transactionName:a}),(0,I.BX)(y.Z,{condensed:!0,children:[(0,I.tZ)(x.Z,{}),(0,I.tZ)(g.Z,{alignDropdown:"left",maxPickableDays:M.bc,relativeOptions:M.CS})]}),(0,I.tZ)(U,{organization:s,projectIds:n.project,query:i,fields:n.fields,onSearch:o("query")}),(0,I.tZ)(m.Z,{value:h.field,options:M.E5.map((e=>({value:e.field,label:e.label}))),onChange:e=>o("sort")(e.value),triggerProps:{prefix:h.prefix},triggerLabel:h.label})]}),(0,I.tZ)(b.Z,{eventView:j,orgSlug:s.slug,location:t,referrer:"api.performance.transaction-spans",cursor:"0:0:1",noPagination:!0,children:e=>{let{tableData:n}=e;const i=n?.data?.[0]??null;return(0,I.tZ)(w.Z,{location:t,orgSlug:s.slug,eventView:T,limit:10,perSuspect:0,spanOps:(0,E.ri)(c)?[c]:[],spanGroups:(0,E.ri)(u)?[u]:[],children:e=>{let{suspectSpans:n,isLoading:o,pageLinks:c}=e;return(0,I.BX)(p.Fragment,{children:[(0,I.tZ)(D.Z,{location:t,organization:s,transactionName:a,project:_.find((e=>e.id===r)),isLoading:o,suspectSpans:n??[],totals:i,sort:h.field}),(0,I.tZ)(S.Z,{pageLinks:c??null})]})}})}})]})}A.displayName="SpansContent";const B=(0,c.Z)("div",{target:"e13h24431"})("display:grid;gap:",(0,T.D)(2),";margin-bottom:",(0,T.D)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:repeat(3, min-content);}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){grid-template-columns:auto auto 1fr auto;}"),U=(0,c.Z)(h.Z,{target:"e13h24430"})("@media (min-width: ",(e=>e.theme.breakpoints.small),"){order:1;grid-column:1/5;}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){order:initial;grid-column:auto;}"),R=A;function Q(e){const{location:t,organization:s,projects:n}=e;return(0,I.tZ)(i.ZP,{location:t,organization:s,projects:n,tab:o.Z.Spans,getDocumentTitle:X,generateEventView:M.xz,childComponent:R})}function X(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,n.t)("Performance")].join(" - "):[(0,n.t)("Summary"),(0,n.t)("Performance")].join(" - ")}Q.displayName="TransactionSpans";const $=(0,a.Z)((0,r.Z)(Q))},"./app/views/performance/transactionSummary/transactionSpans/spanDetails/utils.tsx":(e,t,s)=>{"use strict";function n(e){let{orgSlug:t,transaction:s,query:n,spanSlug:r,projectID:a}=e;const i=function(e){let{orgSlug:t,spanSlug:s}=e;return`/organizations/${t}/performance/summary/spans/${encodeURIComponent(s.op)}:${s.group}/`}({orgSlug:t,spanSlug:r});return{pathname:i,query:{transaction:s,project:a,environment:n.environment,statsPeriod:n.statsPeriod,start:n.start,end:n.end,query:n.query}}}let r;s.d(t,{BP:()=>n,wL:()=>r}),function(e){e.MIN="min",e.MAX="max"}(r||(r={}))},"./app/views/performance/transactionSummary/transactionSpans/suspectSpansTable.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>g});var n=s("./app/components/gridEditable/index.tsx"),r=s("./app/components/gridEditable/sortLink.tsx"),a=s("./app/components/links/link.tsx"),i=s("./app/locale.tsx"),o=s("./app/utils.tsx"),c=s("./app/utils/discover/fieldRenderers.tsx"),p=s("./app/utils/discover/fields.tsx"),l=s("./app/utils/discover/styles.tsx"),u=s("./app/views/performance/transactionSummary/transactionSpans/spanDetails/utils.tsx"),d=s("./app/views/performance/transactionSummary/transactionSpans/types.tsx"),m=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function g(e){const{location:t,organization:s,transactionName:r,isLoading:a,suspectSpans:i,totals:c,sort:p,project:l}=e,u=i.map((e=>({operation:e.op,group:e.group,description:e.description,frequency:(0,o.ri)(e.frequency)&&(0,o.ri)(c?.["count()"])?Math.min(1,e.frequency/c["count()"]):null,avgOccurrences:e.avgOccurrences,p50ExclusiveTime:e.p50ExclusiveTime,p75ExclusiveTime:e.p75ExclusiveTime,p95ExclusiveTime:e.p95ExclusiveTime,p99ExclusiveTime:e.p99ExclusiveTime,sumExclusiveTime:e.sumExclusiveTime})));return(0,m.tZ)(n.ZP,{isLoading:a,data:u,columnOrder:v[p].map((e=>y[e])),columnSortBy:[],grid:{renderHeadCell:x,renderBodyCell:h(t,s,r,l)},location:t})}function x(e,t){const s=(0,p.qG)(e.key,f[e.key]);return(0,m.tZ)(r.Z,{title:e.name,align:s,direction:void 0,canSort:!1,generateSortLink:()=>{}})}function h(e,t,s,n){return(r,o)=>{const p=(0,c.Js)(r.key,f);if("description"===r.key){const c=(0,u.BP)({orgSlug:t.slug,transaction:s,query:e.query,spanSlug:{op:o.operation,group:o.group},projectID:n?.id});return(0,m.tZ)(l.W2,{children:(0,m.tZ)(a.Z,{to:c,children:o[r.key]??(0,i.t)("(unnamed span)")})})}return p(o,{location:e,organization:t})}}g.displayName="SuspectSpansTable",x.displayName="renderHeadCell";const v={[d.g.AVG_OCCURRENCE]:["operation","description","avgOccurrences","frequency","p75ExclusiveTime","sumExclusiveTime"],[d.g.SUM_EXCLUSIVE_TIME]:["operation","description","frequency","p75ExclusiveTime","sumExclusiveTime"],[d.p.P50_EXCLUSIVE_TIME]:["operation","description","frequency","p50ExclusiveTime","sumExclusiveTime"],[d.p.P75_EXCLUSIVE_TIME]:["operation","description","frequency","p75ExclusiveTime","sumExclusiveTime"],[d.p.P95_EXCLUSIVE_TIME]:["operation","description","frequency","p95ExclusiveTime","sumExclusiveTime"],[d.p.P99_EXCLUSIVE_TIME]:["operation","description","frequency","p99ExclusiveTime","sumExclusiveTime"]},y={operation:{key:"operation",name:(0,i.t)("Span Operation"),width:n.z7},description:{key:"description",name:(0,i.t)("Span Name"),width:n.z7},frequency:{key:"frequency",name:(0,i.t)("Frequency"),width:n.z7},avgOccurrences:{key:"avgOccurrences",name:(0,i.t)("Average Occurrences"),width:n.z7},p50ExclusiveTime:{key:"p50ExclusiveTime",name:(0,i.t)("P50 Self Time"),width:n.z7},p75ExclusiveTime:{key:"p75ExclusiveTime",name:(0,i.t)("P75 Self Time"),width:n.z7},p95ExclusiveTime:{key:"p95ExclusiveTime",name:(0,i.t)("P95 Self Time"),width:n.z7},p99ExclusiveTime:{key:"p99ExclusiveTime",name:(0,i.t)("P99 Self Time"),width:n.z7},sumExclusiveTime:{key:"sumExclusiveTime",name:(0,i.t)("Total Self Time"),width:n.z7}},f={operation:"string",description:"string",frequency:"percentage",avgOccurrences:"number",p50ExclusiveTime:"duration",p75ExclusiveTime:"duration",p95ExclusiveTime:"duration",p99ExclusiveTime:"duration",sumExclusiveTime:"duration"}},"../node_modules/lodash/assign.js":(e,t,s)=>{var n=s("../node_modules/lodash/_assignValue.js"),r=s("../node_modules/lodash/_copyObject.js"),a=s("../node_modules/lodash/_createAssigner.js"),i=s("../node_modules/lodash/isArrayLike.js"),o=s("../node_modules/lodash/_isPrototype.js"),c=s("../node_modules/lodash/keys.js"),p=Object.prototype.hasOwnProperty,l=a((function(e,t){if(o(t)||i(t))r(t,c(t),e);else for(var s in t)p.call(t,s)&&n(e,s,t[s])}));e.exports=l}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionSpans_index_tsx.ae5ec5eafba78ab14737b0821d28d78c.js.map