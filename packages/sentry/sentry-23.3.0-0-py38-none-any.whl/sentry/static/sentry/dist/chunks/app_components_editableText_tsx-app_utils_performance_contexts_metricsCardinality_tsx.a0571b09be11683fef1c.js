"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_editableText_tsx-app_utils_performance_contexts_metricsCardinality_tsx"],{"./app/components/editableText.tsx":(e,t,n)=>{n.d(t,{Z:()=>g});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("../node_modules/react/index.js"),r=n("./app/actionCreators/indicator.tsx"),s=n("./app/components/input.tsx"),i=n("./app/components/textOverflow.tsx"),c=n("./app/icons/iconEdit.tsx"),u=n("./app/styles/space.tsx"),l=n("./app/utils.tsx");const d=(e,t)=>{const[n,o]=(0,a.useState)(!1),r=t??document.body;return(0,a.useEffect)((()=>{const t=t=>{let{key:n}=t;n===e&&o(!0)},n=t=>{let{key:n}=t;n===e&&o(!1)};return r.addEventListener("keydown",t),r.addEventListener("keyup",n),()=>{r.removeEventListener("keydown",t),r.removeEventListener("keyup",n)}}),[e,r]),n};var m=n("./app/utils/useOnClickOutside.tsx"),p=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function f(e){let{value:t,onChange:n,name:o,errorMessage:s,successMessage:i,maxLength:u,isDisabled:f=!1,autoSelect:g=!1,className:_,"aria-label":Z}=e;const[E,j]=(0,a.useState)(!1),[D,w]=(0,a.useState)(t),k=!D.trim(),L=(0,a.useRef)(null),P=(0,a.useRef)(null),O=(0,a.useRef)(null),T=d("Enter"),N=d("Escape");function S(){t!==D&&w(t),E&&j(!1)}(0,m.Z)(L,(()=>{E&&(k?M("error"):(D!==t&&(n(D),M("success")),j(!1)))}));const z=(0,a.useCallback)((()=>{if(T){if(k)return void M("error");D!==t&&(n(D),M("success")),j(!1)}}),[T,D,n]),A=(0,a.useCallback)((()=>{N&&S()}),[N]);function M(e){"error"!==e?i&&(0,r.S9)(i):s&&(0,r.Iw)(s)}return(0,a.useEffect)((()=>{S()}),[f,t]),(0,a.useEffect)((()=>{if(E){const e=O.current;(0,l.ri)(e)&&e.focus()}}),[E]),(0,a.useEffect)((()=>{E&&(z(),A())}),[z,A,E]),(0,p.tZ)(C,{isDisabled:f,isEditing:E,className:_,children:E?(0,p.BX)(v,{ref:L,isEmpty:k,"data-test-id":"editable-text-input",children:[(0,p.tZ)(h,{"aria-label":Z,name:o,ref:O,value:D,onChange:function(e){w(e.target.value)},onFocus:e=>g&&e.target.select(),maxLength:u}),(0,p.tZ)(x,{children:D})]}):(0,p.BX)(b,{onClick:f?void 0:function(){j(!0)},ref:P,isDisabled:f,"data-test-id":"editable-text-label",children:[(0,p.tZ)(y,{children:D}),!f&&(0,p.tZ)(c.y,{})]})})}f.displayName="EditableText";const g=f,b=(0,o.Z)("div",{target:"e1jnr83o5"})("display:grid;grid-auto-flow:column;align-items:center;gap:",(0,u.D)(1),";cursor:",(e=>e.isDisabled?"default":"pointer"),";"),y=(0,o.Z)(i.Z,{target:"e1jnr83o4"})("border-top:1px solid transparent;border-bottom:1px dotted ",(e=>e.theme.gray200),";line-height:38px;"),v=(0,o.Z)("div",{target:"e1jnr83o3"})("display:inline-block;background:",(e=>e.theme.gray100),";border-radius:",(e=>e.theme.borderRadius),";margin:-",(0,u.D)(.5)," -",(0,u.D)(1),";padding:",(0,u.D)(.5)," ",(0,u.D)(1),";max-width:calc(100% + ",(0,u.D)(2),");"),h=(0,o.Z)(s.Z,{target:"e1jnr83o2"})({name:"1wplbud",styles:"border:none!important;background:transparent;height:auto;min-height:40px;padding:0;font-size:inherit;&,&:focus,&:active,&:hover{box-shadow:none;}"}),x=(0,o.Z)("div",{target:"e1jnr83o1"})("height:0;opacity:0;white-space:pre;padding:0 ",(0,u.D)(1),";"),C=(0,o.Z)("div",{target:"e1jnr83o0"})("display:flex;",(e=>e.isDisabled&&`\n      ${y} {\n        border-bottom-color: transparent;\n      }\n    `),";")},"./app/utils/performance/contexts/metricsCardinality.tsx":(e,t,n)=>{n.d(t,{BT:()=>x,e0:()=>_}),n("../node_modules/core-js/modules/es.array.includes.js");var o=n("../node_modules/react/index.js"),a=n("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),r=n("./app/utils/dates.tsx"),s=n("./app/utils/discover/eventView.tsx"),i=n("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),c=n("../node_modules/lodash/omit.js"),u=n.n(c),l=n("./app/utils/discover/genericDiscoverQuery.tsx"),d=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){let{eventView:t,location:n}=e;return u()(t.getEventsAPIPayload(n),["field","sort","per_page","query"])}function p(e){let{children:t,...n}=e;return(0,d.tZ)(l.ZP,{route:"metrics-compatibility-sums",getRequestPayload:m,...n,children:e=>{let{tableData:n,...o}=e;return t({tableData:n,...o})}})}function f(e){let{eventView:t,location:n}=e;return u()(t.getEventsAPIPayload(n),["field","sort","per_page","query"])}function g(e){let{children:t,...n}=e;return(0,d.tZ)(l.ZP,{route:"metrics-compatibility",getRequestPayload:f,...n,children:e=>{let{tableData:n,...o}=e;return t({tableData:n,...o})}})}p.displayName="MetricsCompatibilityQuery",g.displayName="MetricsCompatibilitySumsQuery";var b=n("./app/utils/performance/contexts/utils.tsx");const[y,v,h]=(0,b.n)({name:"MetricsCardinalityContext",strict:!1}),x=e=>{if(!(0,i.gp)(e.organization))return(0,d.tZ)(y,{value:{isLoading:!1,outcome:{forceTransactionsOnly:!0}},children:e.children});const t={location:e.location,orgSlug:e.organization.slug,cursor:"0:0:0"},n=s.ZP.fromLocation(e.location);n.fields=[{field:"tpm()"}];const a=function(e){const t=e.clone();return t.start||t.end||(t.statsPeriod?(0,r.YJ)(t.statsPeriod)>1&&(t.statsPeriod="1h",t.start=void 0,t.end=void 0):(t.statsPeriod="1h",t.start=void 0,t.end=void 0)),t}(n);return(0,d.tZ)(o.Fragment,{children:(0,d.tZ)(p,{eventView:a,...t,children:n=>(0,d.tZ)(g,{eventView:a,...t,children:t=>{const o=n.isLoading||t.isLoading,a=n.isLoading||t.isLoading?void 0:function(e,t,n){const o={forceTransactionsOnly:!0},a=n.features.includes("performance-mep-bannerless-ui");if(!e)return o;const r=e.compatible_projects;return t?o:e?function(e){return!Z(e).metricsCount}(e)?o:function(e,t){const n=Z(e);return t?n.nullCount/n.metricsCount>.01:n.nullCount>0}(e,a)?{shouldWarnIncompatibleSDK:!0,forceTransactionsOnly:!0,compatibleProjects:r}:function(e){const t=Z(e);return t.unparamCount>=t.metricsCount}(e)?{shouldNotifyUnnamedTransactions:!0,forceTransactionsOnly:!0,compatibleProjects:r}:function(e,t){const n=Z(e);return t?n.unparamCount/n.metricsCount>.01:n.unparamCount>0}(e,a)?{shouldNotifyUnnamedTransactions:!0,compatibleProjects:r,forceTransactionsOnly:!1}:{forceTransactionsOnly:!1}:o}(n.tableData&&t.tableData?{...n.tableData,...t.tableData}:null,!!n.error&&!!t.error,e.organization);return(0,d.tZ)(C,{sendOutcomeAnalytics:e.sendOutcomeAnalytics,organization:e.organization,value:{isLoading:o,outcome:a},children:e.children})}})})})};x.displayName="MetricsCardinalityProvider";const C=e=>{const t=e.value.outcome?.shouldWarnIncompatibleSDK??!1,n=e.value.outcome?.shouldNotifyUnnamedTransactions??!1,r=!e.value.outcome?.forceTransactionsOnly;return(0,o.useEffect)((()=>{!e.value.isLoading&&e.sendOutcomeAnalytics&&(0,a.Z)("performance_views.mep.metrics_outcome",{organization:e.organization,is_on_metrics:r,fallback_from_null:t,fallback_from_unparam:n})}),[e.organization,e.value.isLoading,r,n,t,e.sendOutcomeAnalytics]),(0,d.tZ)(y,{...e,children:e.children})};C.displayName="Provider",h.Consumer;const _=v;function Z(e){let{sum:t}=e;try{const e=Number(t.metrics);return{metricsCount:e,unparamCount:Number(t.metrics_unparam),nullCount:Number(t.metrics_null)}}catch(e){return{metricsCount:0,unparamCount:0,nullCount:0}}}},"./app/utils/useOnClickOutside.tsx":(e,t,n)=>{n.d(t,{Z:()=>a});var o=n("../node_modules/react/index.js");const a=function(e,t){(0,o.useEffect)((()=>{const n=n=>{const o=e?.current;o&&!o.contains(n.target)&&t(n)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,t])}}}]);
//# sourceMappingURL=../sourcemaps/app_components_editableText_tsx-app_utils_performance_contexts_metricsCardinality_tsx.75c65163f5c920d20a2fedfcd789d246.js.map