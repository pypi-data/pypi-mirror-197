"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationTeams_teamMembers_tsx"],{"./app/components/roleSelectControl.tsx":(e,t,s)=>{s.d(t,{Z:()=>n});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("./app/components/forms/controls/selectControl.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){let{roles:t,disableUnallowed:s,...a}=e;return(0,i.tZ)(r.Z,{options:t?.map((e=>({value:e.id,label:e.name,disabled:s&&!e.allowed||e.isRetired,details:(0,i.tZ)(m,{children:e.desc})}))),showDividers:!0,...a})}o.displayName="RoleSelectControl";const n=o,m=(0,a.Z)("span",{target:"eu9y8de0"})({name:"vad6xm",styles:"display:inline-block;width:20rem"})},"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});var a=s("./app/components/asyncComponent.tsx"),r=s("./app/components/sentryDocumentTitle.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class o extends a.Z{getTitle(){return""}render(){return(0,i.tZ)(r.Z,{title:this.getTitle(),children:this.renderComponent()})}}o.displayName="AsyncView"},"./app/views/settings/organizationTeams/roleOverwriteWarning.tsx":(e,t,s)=>{s.d(t,{Sk:()=>m,d8:()=>d,pu:()=>l});var a=s("./app/components/panels/index.tsx"),r=s("./app/components/tooltip.tsx"),i=s("./app/icons/index.tsx"),o=s("./app/locale.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const m=e=>d(e)?(0,n.tZ)(r.u,{title:p(e),children:(0,n.tZ)(i.aU,{size:"sm",color:"gray300"})}):null;m.displayName="RoleOverwriteIcon";const l=e=>d(e)?(0,n.tZ)(a.aU,{"data-test-id":"alert-role-overwrite",children:p(e)}):null;function d(e){const{orgRole:t,orgRoleList:s,teamRoleList:a}=e,r=s.find((e=>e.id===t));return a.findIndex((e=>e.id===r?.minimumTeamRole))>0}function p(e){const{orgRole:t,orgRoleList:s,teamRoleList:a,isSelf:r}=e,i=s.find((e=>e.id===t)),m=a.find((e=>e.id===i?.minimumTeamRole));return i&&m?(0,o._N)("[selfNoun] organization role as [article] [orgRole] has granted [selfPronoun] a minimum team-level role of [teamRole]",{selfNoun:r?"Your":"This user's",selfPronoun:r?"you":"them",article:"AEIOU".includes(i.name[0])?"an":"a",orgRole:(0,n.tZ)("strong",{children:i.name}),teamRole:(0,n.tZ)("strong",{children:m.name})}):""}l.displayName="RoleOverwritePanelAlert"},"./app/views/settings/organizationTeams/teamMembers.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.regexp.flags.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),o=s("../node_modules/lodash/debounce.js"),n=s.n(o),m=s("./app/actionCreators/indicator.tsx"),l=s("./app/actionCreators/modal.tsx"),d=s("./app/actionCreators/teams.tsx"),p=s("./app/components/avatar/userAvatar.tsx"),c=s("./app/components/dropdownAutoComplete/index.tsx"),u=s("./app/components/dropdownButton.tsx"),h=s("./app/components/emptyMessage.tsx"),g=s("./app/components/links/link.tsx"),b=s("./app/components/loadingError.tsx"),x=s("./app/components/loadingIndicator.tsx"),Z=s("./app/components/pagination.tsx"),f=s("./app/components/panels/index.tsx"),v=s("./app/icons/index.tsx"),y=s("./app/locale.tsx"),w=s("./app/styles/space.tsx"),M=s("./app/utils/withApi.tsx"),R=s("./app/utils/withConfig.tsx"),z=s("./app/utils/withOrganization.tsx"),S=s("./app/views/asyncView.tsx"),T=s("./app/components/button.tsx"),I=s("./app/components/idBadge/index.tsx"),C=s("./app/components/roleSelectControl.tsx"),j=s("./app/views/settings/organizationTeams/roleOverwriteWarning.tsx"),k=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const _=e=>{const{organization:t,member:s,user:a,hasWriteAccess:r,removeMember:i,updateMemberRole:o}=e;return(0,k.BX)(N,{children:[(0,k.tZ)("div",{children:(0,k.tZ)(I.Z,{avatarSize:36,member:s,useLink:!0,orgId:t.slug})}),(0,k.tZ)("div",{children:(0,k.tZ)(q,{hasWriteAccess:r,updateMemberRole:o,organization:t,member:s})}),(0,k.tZ)("div",{children:(0,k.tZ)(B,{hasWriteAccess:r,onClick:()=>i(s),member:s,user:a})})]},s.id)};_.displayName="TeamMembersRow";const q=e=>{const{hasWriteAccess:t,organization:s,member:a,updateMemberRole:r}=e,{orgRoleList:i,teamRoleList:o,features:n}=s;if(!n.includes("team-roles"))return null;const{orgRole:m}=a,l=i.find((e=>e.id===m)),d=a.teamRole||l?.minimumTeamRole,p=o.find((e=>e.id===d))||o[0];return!t||(0,j.d8)({orgRole:m,orgRoleList:i,teamRoleList:o})?(0,k.BX)(A,{children:[p.name,(0,k.tZ)(L,{children:(0,k.tZ)(j.Sk,{orgRole:m,orgRoleList:i,teamRoleList:o})})]}):(0,k.tZ)(D,{children:(0,k.tZ)(C.Z,{roles:o,value:p.id,onChange:e=>r(a,e.value),disableUnallowed:!0})})};q.displayName="TeamRoleSelect";const B=e=>{const{member:t,user:s,hasWriteAccess:a,onClick:r}=e,i=t.email===s.email,o=a||i;return o?t.flags["idp:provisioned"]?(0,k.tZ)(T.zx,{size:"xs",disabled:!0,icon:(0,k.tZ)(v.JZ,{size:"xs",isCircled:!0}),onClick:r,"aria-label":(0,y.t)("Remove"),title:(0,y.t)("Membership to this team is managed through your organization's identity provider."),children:(0,y.t)("Remove")}):(0,k.tZ)(T.zx,{size:"xs",disabled:!o,icon:(0,k.tZ)(v.JZ,{size:"xs",isCircled:!0}),onClick:r,"aria-label":(0,y.t)("Remove"),children:(0,y.t)("Remove")}):null};B.displayName="RemoveButton";const A=(0,r.Z)("div",{target:"eqg848x3"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),L=(0,r.Z)("div",{target:"eqg848x2"})("height:",(0,w.D)(2),";margin-left:",(0,w.D)(1),";"),D=(0,r.Z)("div",{target:"eqg848x1"})({name:"5b6t4c",styles:"display:flex;flex-direction:row;align-items:center;>div:first-child{flex-grow:1;}"}),N=(0,r.Z)(f.Lv,{target:"eqg848x0"})("display:grid;grid-template-columns:minmax(120px, 4fr) minmax(120px, 2fr) minmax(100px, 1fr);gap:",(0,w.D)(2),";align-items:center;>div:last-child{margin-left:auto;}"),O=_;class U extends S.Z{constructor(){super(...arguments),(0,a.Z)(this,"debouncedFetchMembersRequest",n()((e=>this.setState({dropdownBusy:!0},(()=>this.fetchMembersRequest(e)))),200)),(0,a.Z)(this,"fetchMembersRequest",(async e=>{const{organization:t,api:s}=this.props;try{const a=await s.requestPromise(`/organizations/${t.slug}/members/`,{query:{query:e}});this.setState({orgMembers:a,dropdownBusy:!1})}catch(e){(0,m.Iw)((0,y.t)("Unable to load organization members."),{duration:2e3}),this.setState({dropdownBusy:!1})}})),(0,a.Z)(this,"addTeamMember",(e=>{const{organization:t,params:s}=this.props,{orgMembers:a,teamMembers:r}=this.state;this.setState({loading:!0}),this.debouncedFetchMembersRequest(""),(0,d.um)(this.props.api,{orgId:t.slug,teamId:s.teamId,memberId:e.value},{success:()=>{const t=a.find((t=>t.id===e.value));void 0!==t&&(this.setState({loading:!1,error:!1,teamMembers:r.concat([t])}),(0,m.S9)((0,y.t)("Successfully added member to team.")))},error:()=>{this.setState({loading:!1}),(0,m.Iw)((0,y.t)("Unable to add team member."))}})})),(0,a.Z)(this,"removeTeamMember",(e=>{const{organization:t,params:s}=this.props,{teamMembers:a}=this.state;(0,d.s)(this.props.api,{orgId:t.slug,teamId:s.teamId,memberId:e.id},{success:()=>{this.setState({teamMembers:a.filter((t=>t.id!==e.id))}),(0,m.S9)((0,y.t)("Successfully removed member from team."))},error:()=>(0,m.Iw)((0,y.t)("There was an error while trying to remove a member from the team."))})})),(0,a.Z)(this,"updateTeamMemberRole",((e,t)=>{const{organization:s}=this.props,{teamId:a}=this.props.params,r=`/organizations/${s.slug}/members/${e.id}/teams/${a}/`;this.props.api.request(r,{method:"PUT",data:{teamRole:t},success:t=>{const s=[...this.state.teamMembers],a=s.findIndex((t=>t.id===e.id));s[a]={...e,teamRole:t.teamRole},this.setState({teamMembers:s}),(0,m.S9)((0,y.t)("Successfully changed role for team member."))},error:()=>{(0,m.Iw)((0,y.t)("There was an error while trying to change the roles for a team member."))}})})),(0,a.Z)(this,"handleMemberFilterChange",(e=>{this.setState({dropdownBusy:!0}),this.debouncedFetchMembersRequest(e.target.value)}))}getDefaultState(){return{...super.getDefaultState(),loading:!0,error:!1,dropdownBusy:!1,teamMembers:[],orgMembers:[]}}componentDidMount(){this.fetchMembersRequest("")}getEndpoints(){const{organization:e,params:t}=this.props;return[["teamMembers",`/teams/${e.slug}/${t.teamId}/members/`,{},{paginate:!0}]]}renderDropdown(e){const{organization:t,params:s,team:a}=this.props,{orgMembers:r}=this.state,i=new Set(this.state.teamMembers.map((e=>e.id))),o=!!t?.openMembership||e,n=(r||[]).filter((e=>!i.has(e.id))).map((e=>({searchKey:`${e.name} ${e.email}`,value:e.id,label:(0,k.BX)(W,{children:[(0,k.tZ)(F,{user:e,size:24,className:"avatar"}),(0,k.tZ)($,{children:e.name||e.email})]})}))),m=(0,k.BX)(P,{children:[(0,y.t)("Members"),(0,k.tZ)(X,{to:"",onClick:()=>(0,l.openInviteMembersModal)({source:"teams"}),"data-test-id":"invite-member",children:(0,y.t)("Invite Member")})]});return(0,k.tZ)(c.Z,{items:n,alignMenu:"right",onSelect:o?this.addTeamMember:e=>(0,l.openTeamAccessRequestModal)({teamId:s.teamId,orgId:t.slug,memberId:e.value}),menuHeader:m,emptyMessage:(0,y.t)("No members"),onChange:this.handleMemberFilterChange,busy:this.state.dropdownBusy,onClose:()=>this.debouncedFetchMembersRequest(""),disabled:a.flags["idp:provisioned"],children:e=>{let{isOpen:t}=e;return(0,k.tZ)(u.Z,{isOpen:t,size:"xs","data-test-id":"add-member",disabled:a.flags["idp:provisioned"],children:(0,y.t)("Add Member")})}})}render(){if(this.state.loading)return(0,k.tZ)(x.Z,{});if(this.state.error)return(0,k.tZ)(b.Z,{onRetry:this.fetchData});const{organization:e,config:t}=this.props,{teamMembersPageLinks:s}=this.state,{access:a}=e,r=a.includes("org:write")||a.includes("team:admin");return(0,k.BX)(i.Fragment,{children:[(0,k.BX)(f.s_,{children:[(0,k.BX)(f.V9,{hasButtons:!0,children:[(0,k.tZ)("div",{children:(0,y.t)("Members")}),(0,k.tZ)("div",{style:{textTransform:"none"},children:this.renderDropdown(r)})]}),this.state.teamMembers.length?this.state.teamMembers.map((s=>(0,k.tZ)(O,{hasWriteAccess:r,member:s,organization:e,removeMember:this.removeTeamMember,updateMemberRole:this.updateTeamMemberRole,user:t.user},s.id))):(0,k.tZ)(h.Z,{icon:(0,k.tZ)(v.qO,{size:"xl"}),size:"large",children:(0,y.t)("This team has no members")})]}),(0,k.tZ)(Z.Z,{pageLinks:s})]})}}U.displayName="TeamMembers";const W=(0,r.Z)("div",{target:"e1anr5pt4"})("display:grid;grid-template-columns:max-content 1fr;gap:",(0,w.D)(.5),";align-items:center;"),$=(0,r.Z)("div",{target:"e1anr5pt3"})("font-size:",(e=>e.theme.fontSizeSmall),";",(e=>e.theme.overflowEllipsis),";"),F=(0,r.Z)((e=>(0,k.tZ)(p.Z,{...e})),{target:"e1anr5pt2"})({name:"1dy9mco",styles:"min-width:1.75em;min-height:1.75em;width:1.5em;height:1.5em"}),P=(0,r.Z)("div",{target:"e1anr5pt1"})("display:grid;grid-template-columns:1fr max-content;padding:",(0,w.D)(1)," 0;font-size:",(e=>e.theme.fontSizeExtraSmall),";text-transform:uppercase;"),X=(0,r.Z)(g.Z,{target:"e1anr5pt0"})({name:"kxbue8",styles:"text-transform:none"}),E=(0,R.Z)((0,M.Z)((0,z.Z)(U)))}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationTeams_teamMembers_tsx.3d56f6b400c562f0b91225d326ff748b.js.map