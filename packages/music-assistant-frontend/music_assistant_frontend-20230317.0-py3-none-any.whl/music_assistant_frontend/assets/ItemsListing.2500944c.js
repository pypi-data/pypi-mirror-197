import{s as je}from"./vue-virtual-scroller.esm.81de7594.js";/* empty css                             */import{d as He,W as Ye,C as Xe,t as ve,aJ as We,aC as ze,Z as Ge,a,X as Qe,Y as Je,m as B,g as Ze,ah as et,u as tt,r as w,E as W,x as le,b as se,c as ke,aI as ee,o as d,h as P,w as n,l as $,aT as pe,k as C,j as F,B as lt,p as V,v as h,i as K,f as at,s as j,q as A,n as H,F as Y,aU as G,M as q,aV as _e,aW as nt,aX as Q,ak as ot,aY as it,aQ as ne,O as we,aL as st,aM as rt,e as ut,J as ct,aR as dt}from"./index.2367b5b2.js";import{V as mt,P as ft,_ as vt}from"./ListviewItem.vue_vue_type_script_setup_true_lang.0fc18a8b.js";import{_ as Ce,a as pt}from"./MediaItemThumb.vue_vue_type_style_index_0_lang.96a4e687.js";import{a as yt,b as gt}from"./ProviderIcons.vue_vue_type_style_index_0_scoped_c020fdb7_lang.6fba6fba.js";import{d as bt,e as ht,f as kt,g as _t,c as $e,b as U,V as te,a as Ve}from"./VTooltip.b2fc6bf2.js";import{h as wt,g as Ct,M as $t,V as X,j as ie,i as oe,a as ye,k as Vt}from"./VCardText.468b25d6.js";import{V as re}from"./VCard.9b1f3d5d.js";import{V as Se,a as ge}from"./VToolbar.471489af.js";import{M as Ie,e as Ae,m as St,f as It,i as Pe,n as At,P as xe,u as Le,a as N,N as Pt,q as xt,Q as Lt,C as Mt,E as Tt,l as Bt,V as O,T as Et}from"./VBtn.24e07398.js";import{V as Ft,a as Me}from"./VSelect.a4f63aac.js";import{V as J}from"./VDivider.58333c98.js";import{V as Ot,a as Nt}from"./VRow.313f6351.js";import{V as be}from"./VAlert.6e7b3b19.js";import{_ as Rt}from"./_plugin-vue_export-helper.cdc0426e.js";const Dt=wt("flex-grow-1","div","VSpacer");const Ut=He({name:"VBadge",inheritAttrs:!1,props:{bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:Ye,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...Ie({location:"top end"}),...Ae(),...St(),...Xe(),...Ct({transition:"scale-rotate-transition"})},setup(e,o){const{backgroundColorClasses:t,backgroundColorStyles:r}=It(ve(e,"color")),{roundedClasses:p}=Pe(e),{t:f}=We(),{textColorClasses:u,textColorStyles:L}=At(ve(e,"textColor")),{themeClasses:M}=ze(),{locationStyles:T}=xe(e,!0,x=>{var i,S;return(e.floating?e.dot?2:4:e.dot?8:12)+(["top","bottom"].includes(x)?+((i=e.offsetY)!=null?i:0):["left","right"].includes(x)?+((S=e.offsetX)!=null?S:0):0)});return Le(()=>{var x,s,i,S;const k=Number(e.content),b=!e.max||isNaN(k)?e.content:k<=e.max?k:`${e.max}+`,[y,m]=Ge(o.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return a(e.tag,B({class:["v-badge",{"v-badge--bordered":e.bordered,"v-badge--dot":e.dot,"v-badge--floating":e.floating,"v-badge--inline":e.inline}]},m),{default:()=>[a("div",{class:"v-badge__wrapper"},[(x=(s=o.slots).default)==null?void 0:x.call(s),a($t,{transition:e.transition},{default:()=>[Qe(a("span",B({class:["v-badge__badge",M.value,t.value,p.value,u.value],style:[r.value,L.value,e.inline?{}:T.value],"aria-atomic":"true","aria-label":f(e.label,k),"aria-live":"polite",role:"status"},y),[e.dot?void 0:o.slots.badge?(i=(S=o.slots).badge)==null?void 0:i.call(S):e.icon?a(N,{icon:e.icon},null):b]),[[Je,e.modelValue]])]})])]})}),{}}});const Kt=Ze()({name:"VSnackbar",props:{multiLine:Boolean,timeout:{type:[Number,String],default:5e3},vertical:Boolean,...Ie({location:"bottom"}),...Pt(),...Ae(),...xt(),...et(bt({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:t}=o;const r=tt(e,"modelValue"),{locationStyles:p}=xe(e),{positionClasses:f}=Lt(e),{scopeId:u}=ht(),{colorClasses:L,colorStyles:M,variantClasses:T}=Mt(e),{roundedClasses:x}=Pe(e),s=w();W(r,S),W(()=>e.timeout,S),le(()=>{r.value&&S()});let i=-1;function S(){window.clearTimeout(i);const b=Number(e.timeout);!r.value||b===-1||(i=window.setTimeout(()=>{r.value=!1},b))}function k(){window.clearTimeout(i)}return Le(()=>{const[b]=_t(e);return a($e,B({ref:s,class:["v-snackbar",{"v-snackbar--active":r.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--vertical":e.vertical},f.value]},b,{modelValue:r.value,"onUpdate:modelValue":y=>r.value=y,contentProps:B({style:p.value},b.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none"},u),{default:()=>[a("div",{class:["v-snackbar__wrapper",L.value,x.value,T.value],style:[M.value],onPointerenter:k,onPointerleave:S},[Tt(!1,"v-snackbar"),t.default&&a("div",{class:"v-snackbar__content",role:"status","aria-live":"polite"},[t.default()]),t.actions&&a(Bt,{defaults:{VBtn:{variant:"text",ripple:!1}}},{default:()=>[a("div",{class:"v-snackbar__actions"},[t.actions()])]})])],activator:t.activator})}),kt({},s)}}),qt={key:0,style:{position:"absolute",top:"0","background-color":"#82b1ff94",height:"50px"}},jt=["src"],Ht={class:"font-weight-bold line-clamp-1",style:{color:"primary","margin-top":"8px","margin-bottom":"8px"}},Yt=se({__name:"PanelviewItem",props:{item:null,size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1}},emits:["menu","click","select"],setup(e,{emit:o}){const t=e,r=ke(()=>{for(const p of t.item.provider_mappings)if(p.content_type!=null&&p.content_type in[ee.DSF,ee.FLAC,ee.AIFF,ee.WAV]&&(p.sample_rate>48e3||p.bit_depth>16))return`${p.sample_rate}kHz ${p.bit_depth} bits`;return""});return(p,f)=>(d(),P(re,{outlined:"",onClick:f[2]||(f[2]=u=>o("click",e.item)),onContextmenu:f[3]||(f[3]=pe(u=>o("menu",e.item),["right","prevent"]))},{default:n(()=>[a(Ce,{item:e.item,size:e.size},null,8,["item","size"]),e.showCheckboxes?(d(),$("div",qt,[a(mt,{"model-value":e.isSelected,onClick:f[0]||(f[0]=pe(()=>{},["stop"])),"onUpdate:modelValue":f[1]||(f[1]=u=>{o("select",e.item,u)})},null,8,["model-value"])])):C("",!0),F(r)?(d(),$("div",{key:1,class:"hiresicon",style:lt(p.$vuetify.theme.current.dark?"background-color: black":"background-color:white")},[a(U,{bottom:""},{activator:n(({props:u})=>[V("img",B({src:F(yt),height:"35"},u,{style:p.$vuetify.theme.current.dark?"object-fit: contain;":"object-fit: contain;filter: invert(100%);"}),null,16,jt)]),default:n(()=>[V("span",null,h(F(r)),1)]),_:1})],4)):C("",!0),a(X,{"two-line":"",style:{"padding-left":"8px","padding-right":"8px"}},{default:n(()=>[V("div",null,[V("p",Ht,h(e.item.name),1)]),"artists"in e.item&&e.item.artists?(d(),P(ie,{key:0,class:"line-clamp-2",style:{"margin-bottom":"8px"}},{default:n(()=>[K(h(F(pt)(e.item.artists)),1)]),_:1})):"owner"in e.item&&e.item.owner?(d(),P(ie,{key:1,class:"line-clamp-2",style:{"margin-bottom":"8px"}},{default:n(()=>[K(h(e.item.owner),1)]),_:1})):C("",!0)]),_:1})]),_:1}))}}),Xt={key:0},Wt={class:"listitem-thumb"},zt={class:"listitem-actions"},Gt={key:0},Qt={class:"listitem-thumb"},Jt=["src"],Z=function(e){for(const o of e.provider_mappings)if(o.available)return!0;return!1},Zt=function(e){for(const o of e.provider_mappings)if(A.providers[o.provider_instance].supported_features.includes(_e.SIMILAR_TRACKS))return!0;return!1},el=function(e,o){const t=[];if(e.length==0||!Z(e[0]))return t;let r=G.PLAY,p=G.NEXT;return(e.length>10||[q.ALBUM,q.PLAYLIST].includes(e[0].media_type))&&(r=G.REPLACE,p=G.REPLACE_NEXT),e.length==1&&o&&o.media_type==q.PLAYLIST&&t.push({label:"play_playlist_from",action:()=>{A.playPlaylistFromIndex(o,e[0].position||0)},icon:"mdi-play-circle-outline",labelArgs:[],actionStr:"play"}),e.length==1&&o&&o.media_type==q.ALBUM&&t.push({label:"play_album_from",action:()=>{A.playAlbumFromItem(o,e[0])},icon:"mdi-play-circle-outline",labelArgs:[],actionStr:"play"}),t.push({label:"play_now",action:()=>{A.playMedia(e,r)},icon:"mdi-play-circle-outline",labelArgs:[],actionStr:"play"}),Zt(e[0])&&t.push({label:"play_radio",action:()=>{A.playMedia(e,r,!0)},icon:"mdi-radio-tower",labelArgs:[],actionStr:"play"}),(e.length===1||e[0].media_type===q.TRACK)&&t.push({label:"play_next",action:()=>{A.playMedia(e,p)},icon:"mdi-skip-next-circle-outline",labelArgs:[],actionStr:"play"}),t.push({label:"add_queue",action:()=>{A.playMedia(e,G.ADD)},icon:"mdi-playlist-plus",labelArgs:[],actionStr:"play"}),t},tl=function(e,o){const t=[];if(e.length==0)return t;if(e.length===1&&e[0]!==o&&Z(e[0])&&t.push({label:"show_info",labelArgs:[],action:()=>{Q.push({name:e[0].media_type,params:{itemId:e[0].item_id,provider:e[0].provider}})},icon:"mdi-information-outline"}),e.length===1&&Z(e[0])&&"artists"in e[0]&&e[0].artists.length===1)for(const r of e[0].artists)t.push({label:"goto_artist",labelArgs:[r.name],action:()=>{Q.push({name:"artist",params:{itemId:r.item_id,provider:r.provider}})},icon:"mdi-account-music"});if(e.length===1&&Z(e[0])&&"album"in e[0]&&e[0].album&&t.push({label:"goto_album",labelArgs:[e[0].album.name],action:()=>{Q.push({name:"album",params:{itemId:e[0].album.item_id,provider:e[0].album.provider}})},icon:"mdi-album"}),e.length===1&&e[0]==o&&t.push({label:"refresh_item",labelArgs:[],action:async()=>{await A.getItemByUri(e[0].uri,!0,!1),Q.go(0)},icon:"mdi-refresh"}),!e[0].in_library&&Z(e[0])&&t.push({label:"add_library",labelArgs:[],action:()=>{A.addItemsToLibrary(e)},icon:"mdi-heart-outline"}),e[0].in_library&&t.push({label:"remove_library",labelArgs:[],action:()=>{A.removeItemsFromLibrary(e)},icon:"mdi-heart"}),o&&o.media_type===q.PLAYLIST){const r=o;e[0].media_type===q.TRACK&&r.is_editable&&t.push({label:"remove_playlist",labelArgs:[],action:()=>{A.removePlaylistTracks(r.item_id,e.map(p=>p.position))},icon:"mdi-minus-circle-outline"})}return e[0].media_type==="track"&&t.push({label:"add_playlist",labelArgs:[],actionStr:"add_playlist",icon:"mdi-plus-circle-outline"}),e.length==1&&e[0].provider=="database"&&t.push({label:"delete_db",labelArgs:[],action:()=>{A.deleteDbItem(e[0].media_type,e[0].item_id,!0),o&&o.item_id==e[0].item_id&&Q.push({name:`${o.media_type}s`})},icon:"mdi-cancel"}),e.length>1&&t.push({label:"clear_selection",labelArgs:[],actionStr:"clear",icon:"mdi-cancel"}),t},ll=se({__name:"MediaItemContextMenu",props:{items:null,parentItem:{default:void 0},modelValue:{type:Boolean},enablePlayItems:{type:Boolean,default:!0},enableActionMenuItems:{type:Boolean,default:!0},fullscreen:{type:Boolean,default:!0}},emits:["refresh","clear","update:modelValue","update:items"],setup(e,{emit:o}){const t=e,{t:r}=at(),p=w([]),f=w([]),u=w(""),L=w([]),M=w(!1),T=w("");W(()=>t.modelValue,m=>{m&&x()});const x=async function(){if(M.value=!1,L.value=[],!t.items)return;t.items.length===1?u.value=t.items[0].name:u.value=r("items_selected",[t.items.length]).toString(),j.selectedPlayer&&j.selectedPlayer.available?f.value=el(t.items,t.parentItem):f.value=[];let m=t.items[0],I=0;if("position"in m&&(I=m.position),m.provider!=="database"){m=await A.getItemByUri(t.items[0].uri),"position"in m&&(m.position=I);const v=t.items;v[0]=m,o("update:items",v)}p.value=tl(t.items,t.parentItem),s()},s=async function(){L.value=[];const m=await A.getPlaylists();for(const I of m.items)I.is_editable&&!(t.parentItem&&t.parentItem.media_type===q.PLAYLIST&&I.item_id===t.parentItem.item_id)&&L.value.push(I)},i=function(m){A.addPlaylistTracks(m.item_id,t.items.map(I=>I.uri)),b()},S=async function(m){const I=await A.createPlaylist(T.value,m);i(I)},k=async function(m){m.actionStr=="add_playlist"?M.value=!0:m.actionStr=="clear"?(o("clear"),b()):m.action&&m.actionStr=="play"?(m.action(),o("clear"),b()):m.action&&(b(),m.action())},b=function(){t.items.length==1&&o("clear"),o("update:modelValue",!1)},y=ke(()=>{var I,v;const m=[];for(const _ in(I=A)==null?void 0:I.players){const R=(v=A)==null?void 0:v.players[_];R.synced_to||m.push({title:R.name,value:R.player_id})}return m.slice().sort((_,R)=>_.title.toUpperCase()>R.title.toUpperCase()?1:-1)});return(m,I)=>(d(),P($e,{"model-value":e.modelValue,class:"align-center justify-center",scrim:!1},{default:n(()=>[a(Ve,{class:"fullscreen-menu","model-value":e.modelValue},{default:n(()=>[a(re,null,{default:n(()=>[a(Se,{density:"default",dark:"",color:"primary"},{default:n(()=>[a(N,{icon:"mdi-play-circle-outline"}),M.value?(d(),P(ge,{key:0,style:{"padding-left":"10px"}},{default:n(()=>[V("b",null,h(m.$t("add_playlist")),1),m.$vuetify.display.mobile?C("",!0):(d(),$("span",Xt," | "+h(u.value),1))]),_:1})):(d(),P(ge,{key:1,style:{"padding-left":"10px"}},{default:n(()=>[V("b",null,h(u.value),1)]),_:1})),a(O,{icon:"mdi-close",dark:"",text:"",onClick:I[0]||(I[0]=v=>b())})]),_:1}),e.enablePlayItems&&!M.value&&f.value.length>0?(d(),P(oe,{key:0},{default:n(()=>{var v;return[a(Ft,{label:m.$t("play_on"),"model-value":(v=F(j).selectedPlayer)==null?void 0:v.player_id,items:F(y),"hide-details":"","onUpdate:modelValue":I[1]||(I[1]=_=>{F(j).selectedPlayer=F(A).players[_]})},null,8,["label","model-value","items"]),a(te,null,{default:n(()=>[(d(!0),$(Y,null,H(f.value,_=>(d(),$("div",{key:_.label},[a(X,{title:m.$t(_.label,_.labelArgs),density:"default",onClick:R=>k(_)},{prepend:n(()=>[a(ye,{style:{"padding-right":"10px"}},{default:n(()=>[a(N,{icon:_.icon},null,8,["icon"])]),_:2},1024)]),_:2},1032,["title","onClick"]),a(J)]))),128))]),_:1})]}),_:1})):C("",!0),e.enableActionMenuItems&&!M.value&&p.value.length>0?(d(),P(oe,{key:1,style:{"padding-top":"0","margin-top":"-10px","padding-bottom":"0"}},{default:n(()=>[a(ie,{style:{"margin-left":"10px"}},{default:n(()=>[K(h(m.$t("actions")),1)]),_:1}),a(te,null,{default:n(()=>[(d(!0),$(Y,null,H(p.value,v=>(d(),$("div",{key:v.label},[a(X,{title:m.$t(v.label,v.labelArgs),density:"default",onClick:_=>k(v)},{prepend:n(()=>[a(ye,{style:{"padding-right":"10px"}},{default:n(()=>[a(N,{icon:v.icon},null,8,["icon"])]),_:2},1024)]),_:2},1032,["title","onClick"]),a(J)]))),128))]),_:1})]),_:1})):C("",!0),M.value?(d(),P(oe,{key:2},{default:n(()=>[a(te,null,{default:n(()=>[(d(!0),$(Y,null,H(L.value,v=>(d(),$("div",{key:v.item_id},[a(X,{ripple:"",density:"default",onClick:_=>i(v)},{prepend:n(()=>[V("div",Wt,[a(Ce,{item:v,size:50,width:"50px",height:"50px"},null,8,["item"])])]),title:n(()=>[V("div",null,h(v.name),1)]),subtitle:n(()=>[V("div",null,h(v.owner),1)]),append:n(()=>[V("div",zt,[v.provider_mappings?(d(),P(ft,{key:0,"provider-mappings":v.provider_mappings,height:20,class:"listitem-actions"},null,8,["provider-mappings"])):C("",!0)])]),_:2},1032,["onClick"]),a(J)]))),128)),(d(!0),$(Y,null,H(F(A).providers,v=>(d(),$("div",{key:v.instance_id},[v.supported_features.includes(F(_e).PLAYLIST_CREATE)?(d(),$("div",Gt,[a(X,{ripple:""},{prepend:n(()=>[V("div",Qt,[V("img",B(t,{height:40,src:F(gt)(v.type),style:{"margin-left":"5px","margin-top":"5px"}}),null,16,Jt)])]),title:n(()=>[a(Me,{label:m.$t("create_playlist",[v.name]),"append-icon":"mdi-playlist-plus",variant:"plain","hide-details":"","onUpdate:modelValue":I[2]||(I[2]=_=>{T.value=_}),"onClick:append":_=>S(v.instance_id),onKeydown:nt(_=>S(v.instance_id),["enter"])},null,8,["label","onClick:append","onKeydown"])]),_:2},1024),a(J)])):C("",!0)]))),128))]),_:1})]),_:1})):C("",!0)]),_:1})]),_:1},8,["model-value"])]),_:1},8,["model-value"]))}});const Te=(e,o)=>{const t=e.__vccOpts||e;for(const[r,p]of o)t[r]=p;return t},al={},nl=e=>(st("data-v-259be2b2"),e=e(),rt(),e),ol={class:"container"},il=nl(()=>V("div",{class:"spinner"},null,-1)),sl=[il];function rl(e,o){return d(),$("div",ol,sl)}const ul=Te(al,[["render",rl],["__scopeId","data-v-259be2b2"],["__file","/home/oumoussa/side-projects/infinite/src/components/Spinner.vue"]]),cl=e=>({loading(){e.value="loading"},loaded(){e.value="loaded"},complete(){e.value="complete"},error(){e.value="error"}}),dl=(e,o,t)=>()=>{const r=t.parentEl||document.documentElement;t.prevHeight=r.scrollHeight,o.loading(),e("infinite",o)},ml=(e,o)=>{const t=e.getBoundingClientRect();if(!o)return t.top>=0&&t.bottom<=window.innerHeight;const r=o.getBoundingClientRect();return t.top>=r.top&&t.bottom<=r.bottom},he=e=>{e.parentEl=document.querySelector(e.target)||null;let o=`0px 0px ${e.distance}px 0px`;e.top&&(o=`${e.distance}px 0px 0px 0px`);const t=new IntersectionObserver(r=>{r[0].isIntersecting&&(e.firstload&&e.emit(),e.firstload=!0)},{root:e.parentEl,rootMargin:o});return t.observe(e.infiniteLoading.value),t},fl={class:"state-error"},vl={__name:"InfiniteLoading",props:{top:{type:Boolean,required:!1},target:{type:[String,Boolean],required:!1},distance:{type:Number,required:!1,default:0},identifier:{required:!1},firstload:{type:Boolean,required:!1,default:!0},slots:{type:Object,required:!1}},emits:["infinite"],setup(e,{emit:o}){const t=e;let r=null;const p=w(null),f=w("ready"),{top:u,firstload:L,target:M,distance:T}=t,{identifier:x}=ot(t),s={infiniteLoading:p,target:M,top:u,firstload:L,distance:T,prevHeight:0,parentEl:null};s.emit=dl(o,cl(f),s);const i=()=>W(f,async k=>{const b=s.parentEl||document.documentElement;await we(),k=="loaded"&&u&&(b.scrollTop=b.scrollHeight-s.prevHeight),k=="loaded"&&ml(p.value,s.parentEl)&&s.emit(),k=="complete"&&r.disconnect()}),S=()=>W(x,()=>{f.value="ready",r.disconnect(),r=he(s)});return le(()=>{r=he(s),i(),x&&S()}),it(()=>{r.disconnect()}),(k,b)=>(d(),$("div",{ref_key:"infiniteLoading",ref:p},[f.value=="loading"?ne(k.$slots,"spinner",{key:0},()=>[a(ul)],!0):C("v-if",!0),f.value=="complete"?ne(k.$slots,"complete",{key:1},()=>{var y;return[V("span",null,h(((y=e.slots)==null?void 0:y.complete)||"No more results!"),1)]},!0):C("v-if",!0),f.value=="error"?ne(k.$slots,"error",{key:2,retry:s.emit},()=>{var y;return[V("span",fl,[V("span",null,h(((y=e.slots)==null?void 0:y.error)||"Oops something went wrong!"),1),V("button",{class:"retry",onClick:b[0]||(b[0]=(...m)=>s.emit&&s.emit(...m))}," retry ")])]},!0):C("v-if",!0)],512))}},pl=Te(vl,[["__scopeId","data-v-9d82030b"],["__file","/home/oumoussa/side-projects/infinite/src/components/InfiniteLoading.vue"]]);const yl={key:0},gl={key:0},bl={key:1},hl={style:{"margin-left":"15px","margin-right":"15px","margin-top":"20px","margin-bottom":"20px",padding:"0"}},kl={key:2},_l={key:3},Rl=function(e,o,t,r,p,f=!0){var T,x;let u=[];if(p){const s=p.toLowerCase();for(const i of e)(i.name.toLowerCase().includes(s)||"artist"in i&&((T=i.artist)==null?void 0:T.name.toLowerCase().includes(s))||"album"in i&&((x=i.album)==null?void 0:x.name.toLowerCase().includes(s))||"artists"in i&&i.artists&&i.artists[0].name.toLowerCase().includes(s))&&u.push(i)}else u=e;r=="sort_name"&&u.sort((s,i)=>(s.sort_name||s.name).localeCompare(i.sort_name||i.name)),r=="sort_album"&&u.sort((s,i)=>{var S,k;return(k=s.album)==null?void 0:k.name.localeCompare((S=i.album)==null?void 0:S.name)}),r=="sort_artist"&&u.sort((s,i)=>s.artists[0].name.localeCompare(i.artists[0].name)),r=="track_number"&&(u.sort((s,i)=>(s.track_number||0)-(i.track_number||0)),u.sort((s,i)=>(s.disc_number||0)-(i.disc_number||0))),r=="position"&&u.sort((s,i)=>(s.position||0)-(i.position||0)),r=="year"&&u.sort((s,i)=>(s.year||0)-(i.year||0)),r=="timestamp DESC"&&u.sort((s,i)=>(i.timestamp||0)-(s.timestamp||0)),r=="duration"&&u.sort((s,i)=>(s.duration||0)-(i.duration||0)),r=="provider"&&u.sort((s,i)=>s.provider.localeCompare(i.provider)),f&&(u=u.filter(s=>s.in_library));const L=u.length,M=u.slice(o,o+t);return{items:M,count:M.length,limit:t,offset:o,total:L}},wl=se({__name:"ItemsListing",props:{itemtype:null,sortKeys:{default:()=>["sort_name","timestamp DESC"]},showTrackNumber:{type:Boolean,default:!0},showProviders:{type:Boolean,default:Object.keys(A.providers).length>1},showMenu:{type:Boolean,default:!0},showLibrary:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},updateAvailable:{type:Boolean},loadData:null},emits:["toggleAlbumArtistsOnly","refreshClicked"],setup(e,{emit:o}){const t=e,r=100,p=ut(),f=w("list"),u=w(""),L=w("sort_name"),M=w(!1),T=w(!1),x=w(!1),s=w(0),i=w([]),S=w(),k=w(!1),b=w(!1),y=w([]),m=w(!1),I=w(!1),v=w(!1),_=w(!1),R=function(l){return l<500?2:l<=500?3:l<=700?4:l<=1e3?5:l<=1200?6:l<=1500?7:l<=1700?8:l>1700?9:0},Be=function(){T.value?T.value=!1:(T.value=!0,we(()=>{var l;(l=document.getElementById("searchInput"))==null||l.focus()}))},Ee=function(){f.value==="panel"?f.value="list":f.value="panel",localStorage.setItem(`viewMode.${t.itemtype}`,f.value)},Fe=function(){b.value=!b.value;const l=b.value?"true":"false";localStorage.setItem(`libraryFilter.${t.itemtype}`,l),D(!0)},Oe=function(){_.value=!_.value;const l=_.value?"true":"false";localStorage.setItem(`albumArtistsFilter.${t.itemtype}`,l),o("toggleAlbumArtistsOnly",_.value),D(!0)},ue=function(l){return y.value.includes(l)},ce=function(l,g){if(g)y.value.includes(l)||y.value.push(l);else for(let c=0;c<y.value.length;c++)y.value[c]===l&&y.value.splice(c,1);j.blockGlobalPlayMenu=y.value.length>0},Ne=function(){y.value=[],v.value=!1,j.blockGlobalPlayMenu=!1},ae=function(){y.value.length>0?m.value=!0:v.value=!v.value},Re=function(l){D(!0)},de=function(l){y.value=[l],m.value=!0},De=function(){D(!0),o("refreshClicked")},me=function(l){var c;const g=t.itemtype.includes("versions").toString();["artist","album","playlist"].includes(l.media_type)||g=="true"||!((c=j.selectedPlayer)!=null&&c.available)?p.push({name:l.media_type,params:{itemId:l.item_id,provider:l.provider,forceProviderVersion:g}}):j.selectedPlayer&&A.playMedia(l)},Ue=function(l,g){l!==void 0&&(L.value=l),localStorage.setItem(`sortBy.${t.itemtype}`,L.value),D(!0)},Ke=function(l){if(i.value.length==0){l.loaded();return}if(S.value!==void 0&&s.value>=S.value){l.loaded();return}s.value+=r,D().then(()=>{l.loaded()})},qe=function(){localStorage.setItem("globalsearch",u.value),p.push({name:"home"})};W(()=>u.value,l=>{l&&(T.value=!0),D(!0)});const D=async function(l=!1,g=r){l&&(s.value=0,I.value=!1),k.value=!0;const c=await t.loadData(s.value,g,L.value,u.value||"",b.value);s.value?i.value.push(...c.items):i.value=c.items,S.value=c.total,k.value=!1;let E=`search.${t.itemtype}`;t.parentItem&&(E+=t.parentItem.item_id),localStorage.setItem(E,u.value)};le(()=>{const l=localStorage.getItem(`viewMode.${t.itemtype}`);l&&l!=="null"?f.value=l:t.itemtype=="artists"||t.itemtype=="albums"?f.value="panel":f.value="list";const g=localStorage.getItem(`sortBy.${t.itemtype}`);if(g&&g!=="null"?L.value=g:L.value=t.sortKeys[0],t.showLibrary!==!1){const z=localStorage.getItem(`libraryFilter.${t.itemtype}`);z&&z=="true"&&(b.value=!0)}if(t.showAlbumArtistsOnlyFilter!==!1){const z=localStorage.getItem(`albumArtistsFilter.${t.itemtype}`);z&&z=="true"&&(_.value=!0,o("toggleAlbumArtistsOnly",_.value))}let c=`search.${t.itemtype}`;t.parentItem&&(c+=t.parentItem.item_id);const E=localStorage.getItem(c);E&&E!=="null"&&(console.log("savedSearch",E),u.value=E),D(!0)}),le(()=>{});const fe=function(l){m.value||(l.key==="a"&&(l.ctrlKey||l.metaKey)?(l.preventDefault(),y.value=i.value):!x.value&&l.key=="Backspace"?u.value=u.value.slice(0,-1):!x.value&&l.key.length==1&&(u.value+=l.key,T.value=!0))};return document.addEventListener("keydown",fe),ct(()=>{document.removeEventListener("keydown",fe)}),(l,g)=>(d(),$("section",null,[a(Se,{density:"compact",variant:"flat",color:"transparent"},{default:n(()=>[a(U,{location:"bottom"},{activator:n(({props:c})=>[a(O,B(c,{icon:y.value.length>0?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",variant:"plain",onClick:ae}),null,16,["icon"]),l.$vuetify.display.mobile?C("",!0):(d(),$("span",yl,[!y.value.length&&S.value?(d(),$("span",{key:0,style:{cursor:"pointer"},onClick:ae},h(l.$t("items_total",[S.value])),1)):y.value.length?(d(),$("span",{key:1,style:{cursor:"pointer"},onClick:ae},h(l.$t("items_selected",[y.value.length])),1)):C("",!0)]))]),default:n(()=>[V("span",null,h(l.$t("tooltip.select_items")),1)]),_:1}),a(Dt),a(U,{location:"bottom","close-on-content-click":""},{activator:n(({props:c})=>[e.showLibrary!==!1?(d(),P(O,B({key:0},c,{icon:"",variant:"plain",onClick:Fe}),{default:n(()=>[a(N,{icon:b.value?"mdi-heart":"mdi-heart-outline"},null,8,["icon"])]),_:2},1040)):C("",!0)]),default:n(()=>[V("span",null,h(l.$t("tooltip.filter_library")),1)]),_:1}),e.showAlbumArtistsOnlyFilter?(d(),P(U,{key:0,location:"bottom"},{activator:n(({props:c})=>[a(O,B(c,{icon:"",variant:"plain",onClick:Oe}),{default:n(()=>[a(N,{icon:_.value?"mdi-account-music":"mdi-account-music-outline"},null,8,["icon"])]),_:2},1040)]),default:n(()=>[V("span",null,h(l.$t("tooltip.album_artist_filter")),1)]),_:1})):C("",!0),a(U,{location:"bottom"},{activator:n(({props:c})=>[a(O,B(c,{icon:"",variant:"plain",onClick:g[0]||(g[0]=E=>De())}),{default:n(()=>[a(Ut,{"model-value":e.updateAvailable,color:"error",dot:""},{default:n(()=>[a(N,{icon:"mdi-refresh"})]),_:1},8,["model-value"])]),_:2},1040)]),default:n(()=>[e.updateAvailable?(d(),$("span",gl,h(l.$t("tooltip.refresh_new_content")),1)):(d(),$("span",bl,h(l.$t("tooltip.refresh")),1))]),_:1}),e.sortKeys.length>1?(d(),P(Ve,{key:1,modelValue:M.value,"onUpdate:modelValue":g[1]||(g[1]=c=>M.value=c),location:"bottom end","close-on-content-click":!0},{activator:n(({props:c})=>[a(U,{location:"bottom"},{activator:n(({props:E})=>[a(O,B({icon:""},t,{variant:"plain"}),{default:n(()=>[a(N,B(B(c,E),{icon:"mdi-sort"}),null,16)]),_:2},1040)]),default:n(()=>[V("span",null,h(l.$t("tooltip.sort_options")),1)]),_:2},1024)]),default:n(()=>[a(re,null,{default:n(()=>[a(te,null,{default:n(()=>[(d(!0),$(Y,null,H(e.sortKeys,c=>(d(),$("div",{key:c},[a(X,{onClick:E=>Ue(c)},{append:n(()=>[L.value==c?(d(),P(N,{key:0,icon:"mdi-check"})):C("",!0)]),default:n(()=>[a(Vt,null,{default:n(()=>[K(h(l.$t("sort."+c)),1)]),_:2},1024)]),_:2},1032,["onClick"]),a(J)]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])):C("",!0),a(U,{location:"bottom"},{activator:n(({props:c})=>[a(O,B(c,{icon:"",variant:"plain",onClick:g[2]||(g[2]=E=>Be())}),{default:n(()=>[a(N,{icon:"mdi-magnify"})]),_:2},1040)]),default:n(()=>[V("span",null,h(l.$t("tooltip.search")),1)]),_:1}),a(U,{location:"bottom"},{activator:n(({props:c})=>[a(O,B(c,{icon:f.value=="panel"?"mdi-view-list":"mdi-grid",variant:"plain",onClick:g[3]||(g[3]=E=>Ee())}),null,16,["icon"])]),default:n(()=>[V("span",null,h(l.$t("tooltip.toggle_view_mode")),1)]),_:1})]),_:1}),a(ll,{modelValue:m.value,"onUpdate:modelValue":g[4]||(g[4]=c=>m.value=c),items:y.value,"parent-item":e.parentItem,onClear:Ne,onDelete:Re},null,8,["modelValue","items","parent-item"]),T.value?(d(),P(Me,{key:0,id:"searchInput",modelValue:u.value,"onUpdate:modelValue":g[5]||(g[5]=c=>u.value=c),clearable:"","prepend-inner-icon":"mdi-magnify",label:l.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-left":"15px","margin-right":"15px","margin-top":"10px"},onFocus:g[6]||(g[6]=c=>x.value=!0),onBlur:g[7]||(g[7]=c=>x.value=!1)},null,8,["modelValue","label"])):C("",!0),V("div",hl,[k.value?(d(),P(Et,{key:0,indeterminate:""})):C("",!0),f.value=="panel"?(d(),P(Ot,{key:1},{default:n(()=>[(d(!0),$(Y,null,H(i.value,c=>(d(),P(Nt,{key:c.uri,class:dt(`col-${R(l.$vuetify.display.width)}`)},{default:n(()=>[a(Yt,{item:c,"is-selected":ue(c),"show-checkboxes":v.value,onSelect:ce,onMenu:de,onClick:me},null,8,["item","is-selected","show-checkboxes"])]),_:2},1032,["class"]))),128))]),_:1})):C("",!0),f.value=="list"?(d(),$("div",kl,[a(F(je),{items:i.value,"item-size":60,"key-field":"item_id","page-mode":""},{default:n(({item:c})=>[a(vt,{item:c,"show-track-number":e.showTrackNumber,"show-duration":e.showDuration,"show-library":e.showLibrary!==!1&&!b.value,"show-menu":e.showMenu,"show-providers":e.showProviders,"show-checkboxes":v.value,"is-selected":ue(c),"show-details":e.itemtype.includes("versions"),"parent-item":e.parentItem,onSelect:ce,onMenu:de,onClick:me},null,8,["item","show-track-number","show-duration","show-library","show-menu","show-providers","show-checkboxes","is-selected","show-details","parent-item"])]),_:1},8,["items"])])):C("",!0),a(F(pl),{onInfinite:Ke}),!k.value&&i.value.length==0?(d(),$("div",_l,[!k.value&&i.value.length==0&&(u.value||b.value)?(d(),P(be,{key:0,type:"info",color:"grey"},{default:n(()=>[K(h(l.$t("no_content_filter")),1),u.value?(d(),P(O,{key:0,style:{"margin-top":"15px"},onClick:qe},{default:n(()=>[K(h(l.$t("try_global_search")),1)]),_:1})):C("",!0)]),_:1})):!k.value&&i.value.length==0?(d(),P(be,{key:1,type:"info"},{default:n(()=>[K(h(l.$t("no_content")),1)]),_:1})):C("",!0)])):C("",!0),a(Kt,{"model-value":y.value.length>1},{actions:n(()=>[a(O,{color:"primary",variant:"text",onClick:g[8]||(g[8]=c=>m.value=!0)},{default:n(()=>[K(h(l.$t("actions")),1)]),_:1})]),default:n(()=>[V("span",null,h(l.$t("items_selected",[y.value.length])),1)]),_:1},8,["model-value"])])]))}});const Dl=Rt(wl,[["__scopeId","data-v-84b9d50c"]]);export{Dl as I,tl as a,Rl as f,el as g};
