/* empty css                             */import{b as j,e as A,r as F,ab as O,c as q,q as l,a$ as J,J as G,E as H,o,l as m,a as n,w as i,j as d,b0 as w,h as v,p as c,v as _,i as b,k as g,F as D,n as T,m as y,b1 as K,b2 as Q}from"./index.2367b5b2.js";import{b as B}from"./ProviderIcons.vue_vue_type_style_index_0_scoped_c020fdb7_lang.6fba6fba.js";import{V as W}from"./VAlert.6e7b3b19.js";import{a as E,V as M,b as f}from"./VTooltip.b2fc6bf2.js";import{V as S,a as C}from"./VBtn.24e07398.js";import{i as X,V as u,b as x}from"./VCardText.468b25d6.js";import"./VDivider.58333c98.js";const Y=c("br",null,null,-1),Z={class:"listitem-actions"},ee={key:0,class:"listitem-action",style:{"margin-right":"15px"}},te={key:1,class:"listitem-action",style:{"margin-right":"15px"}},ie={key:2,class:"listitem-action",style:{"margin-right":"15px"}},ne={key:3,class:"listitem-action",style:{"margin-right":"15px"}},ae={class:"listitem-action"},ve=j({__name:"MusicProviders",setup(oe){const $=A(),p=F([]),r=O({}),z=q(()=>Object.values(r).filter(t=>!t.builtin&&(t.multi_instance||!p.value.find(s=>s.domain)))),I=l.subscribe(J.PROVIDERS_UPDATED,()=>{V()});G(I);const V=async function(){p.value=await l.getData("config/providers");const t=await l.getData("providers/available");for(const s of t)r[s.domain]=s},N=function(t){l.sendCommand("config/providers/remove",{instance_id:t}),p.value=p.value.filter(s=>s.instance_id!=t)},P=function(t){console.log("editProvider",t),$.push(`/settings/editprovider/${t}`)},R=function(t){console.log("addProvider",t),$.push(`/settings/addprovider/${t.domain}`)},U=function(t){const s={enabled:!t.enabled};l.sendCommand("config/providers/update",{instance_id:t.instance_id,update:s})},L=function(t){l.getData("config/providers/reload",{instance_id:t}).catch(s=>alert(s))};return H(()=>l.providers,t=>{t&&V()},{immediate:!0}),(t,s)=>(o(),m("section",null,[n(X,null,{default:i(()=>[p.value.filter(e=>e.type==d(w).MUSIC&&e.domain in r&&e.domain!="url").length==0?(o(),v(W,{key:0,color:"primary",theme:"dark",icon:"mdi-radio-tower",prominent:""},{default:i(()=>[c("b",null,_(t.$t("settings.no_providers")),1),Y,b(" "+_(t.$t("settings.no_providers_detail")),1)]),_:1})):g("",!0),c("div",null,[(o(!0),m(D,null,T(p.value.filter(e=>e.type==d(w).MUSIC&&e.domain in r),e=>(o(),v(u,{key:e.instance_id,title:e.name||r[e.domain].name,subtitle:r[e.domain].description,onClick:h=>P(e.instance_id)},{prepend:i(()=>[n(x,{contain:"",width:"36px",class:"listitem-thumb",src:d(B)(e.domain)},null,8,["src"])]),append:i(()=>{var h;return[c("div",Z,[d(l).syncTasks.value.filter(a=>a.provider_instance==e.instance_id).length>0?(o(),m("div",ee,[n(f,{location:"top end",origin:"end center"},{activator:i(({props:a})=>[n(C,y(a,{color:"grey"}),{default:i(()=>[b(" mdi-sync ")]),_:2},1040)]),default:i(()=>[c("span",null,_(t.$t("settings.sync_running")),1)]),_:1})])):g("",!0),e.enabled?e.last_error?(o(),m("div",ie,[n(f,{location:"top end",origin:"end center"},{activator:i(({props:a})=>[n(C,y(a,{color:"red"}),{default:i(()=>[b(" mdi-alert-circle ")]),_:2},1040)]),default:i(()=>[c("span",null,_(e.last_error),1)]),_:2},1024)])):(h=d(l).providers[e.instance_id])!=null&&h.available?g("",!0):(o(),m("div",ne,[n(f,{location:"top end",origin:"end center"},{activator:i(({props:a})=>[n(C,K(Q(a)),{default:i(()=>[b(" mdi-timer-sand ")]),_:2},1040)]),default:i(()=>[c("span",null,_(t.$t("settings.not_loaded")),1)]),_:1})])):(o(),m("div",te,[n(f,{location:"top end",origin:"end center"},{activator:i(({props:a})=>[n(C,y(a,{color:"grey"}),{default:i(()=>[b(" mdi-cancel ")]),_:2},1040)]),default:i(()=>[c("span",null,_(t.$t("settings.provider_disabled")),1)]),_:1})])),c("div",ae,[n(E,{location:"bottom end"},{activator:i(({props:a})=>[n(S,y({color:"grey-darken-1",icon:"mdi-dots-vertical",variant:"text"},a,{size:"x-large",style:{"margin-right":"-70px"}}),null,16)]),default:i(()=>[n(M,null,{default:i(()=>{var a;return[n(u,{title:t.$t("settings.configure"),"prepend-icon":"mdi-cog",onClick:k=>P(e.instance_id)},null,8,["title","onClick"]),n(u,{title:e.enabled?t.$t("settings.disable"):t.$t("settings.enable"),"prepend-icon":"mdi-cancel",onClick:k=>U(e),disabled:r[e.domain].builtin},null,8,["title","onClick","disabled"]),r[e.domain].documentation?(o(),v(u,{key:0,title:t.$t("settings.documentation"),"prepend-icon":"mdi-bookshelf",href:r[e.domain].documentation,target:"_blank"},null,8,["title","href"])):g("",!0),(a=d(l).providers[e.instance_id])!=null&&a.available?(o(),v(u,{key:1,title:t.$t("settings.sync"),"prepend-icon":"mdi-sync",onClick:k=>d(l).startSync(void 0,[e.instance_id])},null,8,["title","onClick"])):g("",!0),r[e.domain].builtin?g("",!0):(o(),v(u,{key:2,title:t.$t("settings.delete"),"prepend-icon":"mdi-delete",onClick:k=>N(e.instance_id)},null,8,["title","onClick"])),n(u,{title:t.$t("settings.reload"),"prepend-icon":"mdi-refresh",onClick:k=>L(e.instance_id)},null,8,["title","onClick"])]}),_:2},1024)]),_:2},1024)])])]}),_:2},1032,["title","subtitle","onClick"]))),128))]),n(E,{location:"bottom end","min-width":"500"},{activator:i(({props:e})=>[n(S,y({color:"primary",icon:"mdi-plus",size:"x-large",position:"fixed",location:"bottom right",elevation:"8",style:{"margin-bottom":"180px","margin-right":"15px","z-index":"9999"}},e),null,16)]),default:i(()=>[n(M,null,{default:i(()=>[(o(!0),m(D,null,T(d(z),e=>(o(),v(u,{key:e.domain,title:e.name,onClick:h=>R(e)},{prepend:i(()=>[n(x,{contain:"",width:"26px",style:{"margin-right":"20px"},src:d(B)(e.domain)},null,8,["src"])]),_:2},1032,["title","onClick"]))),128))]),_:1})]),_:1})]),_:1})]))}});export{ve as default};
